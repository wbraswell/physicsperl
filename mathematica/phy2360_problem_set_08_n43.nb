Notebook[{Cell[
BoxData[{RowBox[{"ClearAll","[","q","]",";"," "," ","ClearAll","[","t","]",";"," "," ","ClearAll","[","tau","]",";"," "," ","ClearAll","[","Q","]",";"," "," ","ClearAll","[","T","]",";"," "}],"\n",RowBox[
{"ClearAll","[","q\[LetterSpace]period\[LetterSpace]length","]",";"," ","ClearAll","[","q\[LetterSpace]period","]",";"," ","ClearAll","[","q\[LetterSpace]charge\[LetterSpace]condition","]",";"," ","ClearAll","[","q\[LetterSpace]discharge\[LetterSpace]condition","]",";"," ","ClearAll","[","q\[LetterSpace]period\[LetterSpace]test","]",";"}],"\n",RowBox[
{"ClearAll","[","n","]",";"}],"\n",RowBox[{"q","[","0","]","=","1",";"}],"\n",RowBox[
{"tau","=","1",";"}],"\n",RowBox[{"q\[LetterSpace]period\[LetterSpace]length","=","20","*","tau",";"}],"\n",RowBox[
{"q\[LetterSpace]period\[LetterSpace]number","[","t_","]","=","IntegerPart","[","(","t","*","tau",")","/","q\[LetterSpace]period\[LetterSpace]length","]",";"}],"\n",RowBox[
{"q\[LetterSpace]period","[","t_","]","=","Mod","[","(","t","/","q\[LetterSpace]period\[LetterSpace]length",")",",","tau","]",";"}],"\n",RowBox[
{"q\[LetterSpace]charge\[LetterSpace]condition","[","t_","]","=","q\[LetterSpace]period","[","t","]","<","0.5",";"}],"\n",RowBox[
{"q\[LetterSpace]discharge\[LetterSpace]condition","[","t_","]","=","q\[LetterSpace]period","[","t","]","\[GreaterEqual]","0.5",";"}],"\n",RowBox[
{"q\[LetterSpace]period\[LetterSpace]test","[","t_","]","=","Piecewise","[","{","{","0",","," ","q\[LetterSpace]charge\[LetterSpace]condition","[","t","]","}",",","{","1",",","q\[LetterSpace]discharge\[LetterSpace]condition","[","t","]","}","}","]",";"}],"\n",RowBox[
{"q","[","t_","]","=","Piecewise","[","{","\n","{","q","[","0","]","*","(","1","-","E","^","(","-","(","t","-","(","q\[LetterSpace]period\[LetterSpace]number","[","t","]","*","q\[LetterSpace]period\[LetterSpace]length",")",")","/","tau",")",")",",","\n","q\[LetterSpace]charge\[LetterSpace]condition","[","t","]","}",",","\n","{","q","[","0","]","*","(","1","-","E","^","(","-","10",")",")","*","(","E","^","(","-","(","(","(","t","-","(","q\[LetterSpace]period\[LetterSpace]number","[","t","]","*","q\[LetterSpace]period\[LetterSpace]length",")",")","-","(","10","*","tau",")",")","/","tau",")",")",")",",","\n","q\[LetterSpace]discharge\[LetterSpace]condition","[","t","]","}","}","]"}],"\n",RowBox[
{"(*Plot[{q\[LetterSpace]period\[LetterSpace]number[t],q\[LetterSpace]period[t],q\[LetterSpace]period\[LetterSpace]test[t],q[t]},{t,0,3*q\[LetterSpace]period\[LetterSpace]length}]*)","\n","(*Plot[{q\[LetterSpace]period\[LetterSpace]number[t],q\[LetterSpace]period[t]},{t,0,3*q\[LetterSpace]period\[LetterSpace]length}]*)","\n","Plot","[","q","[","t","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"}]}],
"Input",CellID->1,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"Q","[","t_","]","=","q","[","t","]","/","q","[","0","]",";"," "," ","(*N43a*)"}],"\n",RowBox[
{"T","[","t_","]","=","t","/","tau",";"," "," ","(*N43a*)"}],"\n",RowBox[{"Q\[LetterSpace]T\[LetterSpace]table","=","Table","[","{","Q","[","t","]",",","T","[","t","]","}",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length",",","0.1","}","]",";"," "," ","(*N43a*)"}],"\n",RowBox[
{"(*ListPlot[Q\[LetterSpace]T\[LetterSpace]table]*)"," "," ","(*N43a*)","\n","ListLinePlot","[","Q\[LetterSpace]T\[LetterSpace]table","]"," "," ","(*N43a*)"}]}],
"Input",CellID->425,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"ClearAll","[","fourier\[LetterSpace]parameter\[LetterSpace]1","]",";"," ","ClearAll","[","fourier\[LetterSpace]parameter\[LetterSpace]2","]",";"}],"\n",RowBox[
{"fourier\[LetterSpace]parameters","=","Solve","[","\n","(","Abs","[","(","2","*","fourier\[LetterSpace]parameter\[LetterSpace]2",")","/","Pi","]",")","^","(","(","fourier\[LetterSpace]parameter\[LetterSpace]1","+","1",")","/","2",")","==","(","2","/","q\[LetterSpace]period\[LetterSpace]length",")","&&","\n","Pi","/","Abs","[","fourier\[LetterSpace]parameter\[LetterSpace]2","]","==","q\[LetterSpace]period\[LetterSpace]length",",","\n","{","fourier\[LetterSpace]parameter\[LetterSpace]1",",","fourier\[LetterSpace]parameter\[LetterSpace]2","}","]"}],"\n",RowBox[
{"Set"," ","@@@"," ","fourier\[LetterSpace]parameters","[","[","1","]","]",";"," "," ","(*"," ","set"," ","vars"," ","to"," ","be"," ","globally"," ","accessible"," ","*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]0\[LetterSpace]auto","=","FourierCosCoefficient","[","q","[","t","]",",","t",",","0",",","FourierParameters","\[Rule]","{","fourier\[LetterSpace]parameter\[LetterSpace]1",",","fourier\[LetterSpace]parameter\[LetterSpace]2","}","]"," "," ","(*N43b*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]1\[LetterSpace]auto","=","FourierCosCoefficient","[","q","[","t","]",",","t",",","1",",","FourierParameters","\[Rule]","{","fourier\[LetterSpace]parameter\[LetterSpace]1",",","fourier\[LetterSpace]parameter\[LetterSpace]2","}","]"," "," ","(*N43b*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]1\[LetterSpace]auto","=","FourierSinCoefficient","[","q","[","t","]",",","t",",","1",",","FourierParameters","\[Rule]","{","fourier\[LetterSpace]parameter\[LetterSpace]1",",","fourier\[LetterSpace]parameter\[LetterSpace]2","}","]"," "," ","(*N43b*)"}]}],
"Input",CellID->406,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]0\[LetterSpace]manual","=","(","2","/","q\[LetterSpace]period\[LetterSpace]length",")","*","Integrate","[","q","[","t","]",",","{","t",",","0",",","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43b*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]1\[LetterSpace]manual","=","(","2","/","q\[LetterSpace]period\[LetterSpace]length",")","*","Integrate","[","q","[","t","]","*","Cos","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","1","*","t",")","]",",","{","t",",","0",",","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43b*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]1\[LetterSpace]manual","=","(","2","/","q\[LetterSpace]period\[LetterSpace]length",")","*","Integrate","[","q","[","t","]","*","Sin","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","1","*","t",")","]",",","{","t",",","0",",","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43b*)"}]}],
"Input",CellID->756,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]n\[LetterSpace]auto","[","n_","]","=","FourierCosCoefficient","[","q","[","t","]",",","t",",","n",",","FourierParameters","\[Rule]","{","fourier\[LetterSpace]parameter\[LetterSpace]1",",","fourier\[LetterSpace]parameter\[LetterSpace]2","}","]"," "," ","(*N43c*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]n\[LetterSpace]auto","[","n_","]","=","FourierSinCoefficient","[","q","[","t","]",",","t",",","n",",","FourierParameters","\[Rule]","{","fourier\[LetterSpace]parameter\[LetterSpace]1",",","fourier\[LetterSpace]parameter\[LetterSpace]2","}","]"," "," ","(*N43c*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]n\[LetterSpace]auto","[","1","]"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]n\[LetterSpace]auto","[","1","]"}]}],
"Input",CellID->845,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"\n","q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]n\[LetterSpace]manual","[","n_","]","=","(","2","/","q\[LetterSpace]period\[LetterSpace]length",")","*","Integrate","[","q","[","t","]","*","Cos","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","n","*","t",")","]",",","{","t",",","0",",","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43c*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]n\[LetterSpace]manual","[","n_","]","=","(","2","/","q\[LetterSpace]period\[LetterSpace]length",")","*","Integrate","[","q","[","t","]","*","Sin","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","n","*","t",")","]",",","{","t",",","0",",","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43c*)"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]n\[LetterSpace]manual","[","1","]"}],"\n",RowBox[
{"q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]n\[LetterSpace]manual","[","1","]"}]}],
"Input",CellID->75,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"Q\[LetterSpace]auto","[","T_",",","m_","]","=","(","q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]0\[LetterSpace]auto","/","2",")","+","Sum","[","\n","(","q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]n\[LetterSpace]auto","[","n","]","*","Cos","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","n","*","t",")","]",")","+","\n","(","q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]n\[LetterSpace]auto","[","n","]","*","Sin","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","n","*","t",")","]",")",","," ","\n","{","n",",","1",",","m","}","]"," "," ","(*N43d*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]auto","[","T",",","1","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]auto","[","T",",","2","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]auto","[","T",",","3","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]auto","[","T",",","4","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]auto","[","T",",","5","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","{","Q\[LetterSpace]auto","[","T",",","1","]",",","Q\[LetterSpace]auto","[","T",",","2","]",",","Q\[LetterSpace]auto","[","T",",","3","]",",","Q\[LetterSpace]auto","[","T",",","4","]",",","Q\[LetterSpace]auto","[","T",",","5","]","}",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}]}],
"Input",CellID->113,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"Q\[LetterSpace]manual","[","T_",",","m_","]","=","(","q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]0\[LetterSpace]manual","/","2",")","+","Sum","[","\n","(","q\[LetterSpace]fourier\[LetterSpace]a\[LetterSpace]n\[LetterSpace]manual","[","n","]","*","Cos","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","n","*","t",")","]",")","+","\n","(","q\[LetterSpace]fourier\[LetterSpace]b\[LetterSpace]n\[LetterSpace]manual","[","n","]","*","Sin","[","(","fourier\[LetterSpace]parameter\[LetterSpace]2","*","n","*","t",")","]",")",","," ","\n","{","n",",","1",",","m","}","]"," "," ","(*N43d*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]manual","[","T",",","1","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]manual","[","T",",","2","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]manual","[","T",",","3","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]manual","[","T",",","4","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","Q\[LetterSpace]manual","[","T",",","5","]",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}],"\n",RowBox[
{"Plot","[","{","Q\[LetterSpace]manual","[","T",",","1","]",",","Q\[LetterSpace]manual","[","T",",","2","]",",","Q\[LetterSpace]manual","[","T",",","3","]",",","Q\[LetterSpace]manual","[","T",",","4","]",",","Q\[LetterSpace]manual","[","T",",","5","]","}",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43e*)"}]}],
"Input",CellID->245,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"(*"," ","UNTESTED"," ","CODE"," ","FROM"," ","HERE"," ","TO"," ","BOTTOM"," ","OF"," ","FILE"," ","*)","\n","delta\[LetterSpace]auto","[","T_",",","m_","]","=","Abs","[","Q_auto","[","T","[","t","]",",","m","]","-","Q","[","T","[","t","]","]","]"," "," ","(*N43f*)"}],"\n",RowBox[
{"error\[LetterSpace]auto","[","T_",",","m_","]","=","NIntegrate","[","delta\[LetterSpace]auto","[","T","[","t","]",",","m","]",",","{","t",",","0",",","q\[LetterSpace]period\[LetterSpace]length","}","]"," "," ","(*N43f*)"}],"\n",RowBox[
{"error\[LetterSpace]auto\[LetterSpace]table","=","Table","[","{","error\[LetterSpace]auto","[","T","[","t","]",",","m","]",",","T","[","t","]","}",",","{","t",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length",",","0.1","}",",","{","m",",","1",",","5",",","1","}","]"," "," ","(*N43f*)"}],"\n",RowBox[
{"(*ListPlot[error\[LetterSpace]auto\[LetterSpace]table]*)"," "," ","(*N43f*)","\n","ListLinePlot","[","error\[LetterSpace]auto\[LetterSpace]table","]"," "," ","(*N43f*)"}]}],
"Input",CellID->262,CellLabel->"In[49]:= "],Cell[
BoxData[{RowBox[{"Q\[LetterSpace]table\[LetterSpace]final","=","Table","[","{","Q_manual","[","T",",","m","]",",","T","[","t","]","}",",","{","m",",","1",",","10","}","]"," "," ","(*N43g*)"}],"\n",RowBox[
{"Q\[LetterSpace]table\[LetterSpace]final\[LetterSpace]plot","=","ListLinePlot","[","Q\[LetterSpace]table\[LetterSpace]final",",","PlotLegends","\[Rule]","Automatic","]",";"," "," ","(*N43g*)"}],"\n",RowBox[
{"Q\[LetterSpace]exact\[LetterSpace]plot","=","Plot","[","Q","[","T","]",",","{","T",",","0",",","3","*","q\[LetterSpace]period\[LetterSpace]length","}",",","PlotLegends","\[Rule]","{","\"Q[T] exact\"","}","]",";"," "," ","(*N43g*)"}],"\n",RowBox[
{"Show","[","Q\[LetterSpace]table\[LetterSpace]final\[LetterSpace]plot",",","Q\[LetterSpace]exact\[LetterSpace]plot",","," ","PlotRange"," ","\[Rule]"," ","All",",","AxesLabel","\[Rule]","{","Q",",","T","}","]"," "," ","(*N43g*)"}]}],
"Input",CellID->23,CellLabel->"In[49]:= "]},StyleDefinitions->"Default.nb",WindowSize->{976,610},
FrontEndVersion->"10.0 for Wolfram Cloud Platform (June 2 2014)"]